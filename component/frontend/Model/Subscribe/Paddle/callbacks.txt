Notes on callbacks I need to create

HighRiskTransactionCreated -- Update subscription record
================================================================================
passthrough -- subscription ID
case_id
risk_score
status	-- MUST be 'pending'

Set the payment status to 'P' (Pending).
Create a note "Transaction flagged as high risk on [DATE_TZ]. Case ID [CASE_ID], risk score [RISK_SCORE]%\n"

HighRiskTransactionUpdated -- Update subscription record
================================================================================
passthrough -- subscription ID
case_id
risk_score
status -- accepted OR rejected

IF status == 'accepted'
	Set payment status to 'C'
	Add note "High risk transaction cleared on [DATE_TZ]. Case ID [CASE_ID], risk score [RISK_SCORE]%\n"

IF status == 'rejected'
	Set payment status to 'X'
	Add note "High risk transaction rejected on [DATE_TZ]. Case ID [CASE_ID], risk score [RISK_SCORE]%\n"

PaymentDisputeCreated -- Update subscription record
================================================================================
passthrough -- subscription ID
status -- MUST be 'open'

Set payment_status to 'P' (Pending).
Create a note "Payment dispute opened on [DATE_TZ]. Subscription deactivated temporarily.%\n"

PaymentDisputeClosed -- Update subscription record
================================================================================
passthrough -- subscription ID
status -- MUST be 'closed'

If the payment_state is X or N do nothing; return.
If the payment_state is P or C set it to X and set enabled to 0.

TODO - Recurring callbacks

JAVASCRIPT HANDLERS
================================================================================
Payment closed: show the Abandoned Order page.

Payment success: go through Message.show to redirect the user to the correct message page.


WHAT HAPPENS WHEN USER CANCELS AN ABANDONED SUBSCRIPTION
================================================================================
The record is removed
If the user was blocked, unblock them.
The user is sent to the Level page with the message "The subscription attempt has been canceled at your request. If you would like to retry subscribing please use the form below."


PENDING PAYMENT PAGE
================================================================================
Use the message from the component's Options.

PAYMENT CANCELLATION PAGE
================================================================================
Use the message from the component's Options. I could use this as the default:

Your payment failed. You have not been charged.

Please contact <Paddle's success team>. They will help you with any payment issue or question you may have.

(I think I need to somehow include the order ID / checkout ID, if available? Or at least reference the payment URL?)


ABANDONED ORDER PAGE
================================================================================
>> Use a token OR rely on the session to allow access to it for blocked accounts
>> If the user accesses this page from an email link (that is, with a token) unblock them


Hi there!

You had started purchasing a [LEVEL] subscription with username [USERNAME] on [CREATED_ON] but you didn't get the chance to finish paying for it. Would you like to retry the payment?

[ Retry payment ]  -- [ I changed my mind ]

Did you have an issue? Let us help you!

Change the country
    On the payment popup look at its bottom right. There's a "Log out" link. Click on it. You can now re-enter your email address and select a different country.
    Pro tip: We will remember your country selection next time you buy something from us!

Enter my VAT / tax ID
    On the payment popup look at its bottom left. You can enter the tax ID there _without_ the country prefix. For example, enter 012345678 instead of EL012345678.
    If the VAT / tax ID is not accepted please check that the detected country is correct. Unsure? See above how to change your country.

Use a different payment method
    No problem! Click here to retry paying with a different payment method.

Enter a coupon code
    Click on "I changed my mind". Then retry subscribing. Before you click "Subscribe Now" look below the price. There's an option there to enter your coupon code.

Payment issue
    We are sorry to hear that! Please contact the <success team> of our reseller, Paddle, to help you sort it out. They are really good at figuring these things out, we promise!


RETRY TO SUBSCRIBE ON A PENDING LEVEL WITHIN A WEEK -- Level PAGE, ABOVE Subscribe Now, WITHOUT ToS ACCEPTANCE.
================================================================================

You had started buying this product on [DATE].

[ Resume payment ] -- [ Start over ]

Did you have an issue? Let us help you! (same as Pending page MINUS Enter a coupon code, it needs different text, see below)

Enter a coupon code
    Click on "Start over". Before you click "Subscribe Now" look below the price. There's an option there to enter your coupon code.
